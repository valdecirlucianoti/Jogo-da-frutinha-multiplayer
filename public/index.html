<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Jogo Multiplayer</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel='stylesheet' type='text/css' media='screen' href='./css/reset.css'>
    <link rel='stylesheet' type='text/css' media='screen' href='./css/main.css'>
    <link rel="icon" href="./images/icons8-apple-arcade-16.png">
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <canvas id="screen" width="10" height="10"></canvas>

    <script type="module">
        import createGame from "./game.js";
        import createKeyboardListener from "./Keyboard-Listener.js";
        import renderScreen from "./render-Screen.js";

        const game = createGame();
        const KeyboardListener = createKeyboardListener(document);
        KeyboardListener.subscribe(game.movePlayer);

        const screen = document.getElementById('screen');
        renderScreen(screen, game, requestAnimationFrame);

        const socket = io();

        socket.on('connect', () => {
            const playerId = socket.id;
            console.log(`> Player connected on Client with id: ${playerId}`);
        });

        socket.on('setup', (state) => {
            console.log(`Receiving "Setup" event from server`);
            console.log(state);
            game.setState(state);
        });
    </script>
</body>
</html>